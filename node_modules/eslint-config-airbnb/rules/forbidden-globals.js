/**
 * @fileoverview Rule to flag use of certain forbidden globals such as `Map` or `Set`
 * @author Jake Teton-Landis (cribbed from some github comments by @silverwind)
 */

function message(name) {
  return 'You reference global variable `' + name + '` but it is forbidden, ' +
    'probably due to browser compatibility reasons. ' +
    'Please remove this reference and choose another implementation strategy.';
}

module.exports = function(context) {
  return {
    'Program:exit': function() {
      context.getScope().through.forEach(function(ref) {
        if (ref.identifier.name === 'Buffer') {
            context.report(ref.identifier, msg);
        }
      });
    }
  }
}

module.exports.schema = [

]
